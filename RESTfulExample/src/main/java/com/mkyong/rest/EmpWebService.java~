package com.mkyong.rest;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import javax.ws.rs.core.Response;
import javax.ws.rs.Consumes;
import javax.ws.rs.POST;
import java.sql.*;


@Path("/employee")
public class EmpWebService {
    @POST
    @Path("/insert")
    @Consumes("application/json")
    public Response getEmployeeDetails(Employee employee) throws SQLException{
        //ResultSet rs=null;
        Connection con=null;
        PreparedStatement pstmt=null;
        employee = new Employee();
        String output="";
        try {

            //Register the database
            Class.forName("com.mysql.jdbc.Driver");
            //get a connection to the mysql database
            con = DriverManager.getConnection("jdbc:mysql://localhost:3306/demo","chaitu","chaitu");  
            pstmt = con.prepareStatement("insert into employee(eid,ename,esalary,deptid) values(?,?,?,?)");
            pstmt.setInt(1,employee.getEid());
            pstmt.setString(2,employee.getEname());
            pstmt.setFloat(3,employee.getEsalary());
            pstmt.setInt(4,103);
            int var = pstmt.executeUpdate();
            output =  "emp name " + employee.getEname() + "emp salary" + employee.getEsalary();
        }
        catch(SQLException se) {
            output = se.toString();
        }
        catch(Exception e) {
            output = e.toString();
        }
        finally {
           // rs.close();
            pstmt.close();
            con.close();
        }
        return Response.status(201).entity(output).build(); 
    }
}
